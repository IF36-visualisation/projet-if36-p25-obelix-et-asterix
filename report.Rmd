## Introduction

### Contexte et objectif

Dans le cadre de ce projet, nous avons travaillé avec **deux jeux de données différents mais complémentaires**. Ces données permettent d’explorer plusieurs aspects du commerce de détail : les ventes, les produits, les clients, la rentabilité, etc.

- Le premier fichier, appelé *Superstore*, regroupe presque 10 000 lignes de commandes passées dans une entreprise fictive de e-commerce.
- Le second fichier, basé sur des ventes dans des magasins Walmart, contient des données orientées “point de vente” : horaires, satisfaction client, modes de paiement...

L’objectif est de **mener une exploration** sur les données. Nous avons voulu comprendre comment ces systèmes fonctionnent, ce qui génère du profit ou non, et peut-être découvrir des profils de clients, des tendances d’achat ou des produits phares.


## Question 3 : Est-ce qu’une réduction fait toujours gagner de l’argent ?

---

### Réflexion initiale

Nous nous sommes posé la question suivante : **Accorder une remise sur une vente assure-t-il toujours un bénéfice ?**  
Intuitivement, nous avons supposé que si la remise est modérée, elle pourrait stimuler les ventes sans trop impacter le profit ; mais qu'une remise trop importante risquerait au contraire de générer des pertes.

Pour valider ou invalider cette intuition, nous avons décidé de suivre une démarche en deux temps :  
- Visualiser la relation globale entre le taux de remise et le profit.  
- Approfondir l'analyse en étudiant la distribution du profit pour différents niveaux de remise.


### Méthode

Pour répondre à cette question, nous exploitons le jeu de données **Superstore**, qui contient deux variables clés :  
- `Discount` : le taux de remise appliqué sur chaque vente (entre 0% et 80%).  
- `Profit` : le bénéfice réalisé sur chaque vente.  

Notre approche comporte plusieurs étapes :

1. **Analyse exploratoire initiale** :  
   Nous utilisons d'abord un scatter plot combiné à une courbe de régression linéaire pour observer la tendance globale entre le taux de remise et le profit.

2. **Approfondissement avec une analyse catégorielle** :  
   Afin d'aller plus loin et mieux comprendre l'impact des différents niveaux de remise, nous introduisons un boxplot par groupe de taux de remise.

**Pourquoi utiliser également un boxplot ?**  
- Le boxplot nous permet d'analyser plus précisément la distribution du profit dans chaque catégorie de remise, en visualisant la médiane, les quartiles et les valeurs atypiques.  
- Cela apporte une vision plus claire et comparative entre les différents niveaux de remise.


### Visualisation

#### Partie 1 - Scatter plot : Discount vs Profit

```{r message=FALSE}
library(ggplot2)
library(dplyr)
library(readr)

# Lire les données Superstore
superstore <- read_csv("data/superstore.csv", show_col_types = FALSE)

# Visualiser Discount vs Profit avec une courbe de tendance
ggplot(superstore, aes(x = Discount, y = Profit)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", color = "blue", se = FALSE) +
  labs(title = "Relation entre Discount et Profit (Superstore)",
       x = "Taux de remise (Discount)",
       y = "Profit ($)") +
  theme_minimal()
```


#### Partie 2 - Boxplot : Profit par groupe de Discount

```{r}
# Nettoyer les données
superstore_clean <- superstore %>%
  filter(!is.na(Discount), !is.na(Profit))

# Créer des groupes de Discount
superstore_clean <- superstore_clean %>%
  mutate(Discount_Group = case_when(
    Discount == 0 ~ "0%",
    Discount > 0 & Discount <= 0.2 ~ "0%-20%",
    Discount > 0.2 & Discount <= 0.4 ~ "20%-40%",
    Discount > 0.4 & Discount <= 0.6 ~ "40%-60%",
    Discount > 0.6 ~ "60%-80%"
  ))

# Visualiser Boxplot
ggplot(superstore_clean, aes(x = Discount_Group, y = Profit, fill = Discount_Group)) +
  geom_boxplot() +
  labs(title = "Distribution du profit selon le taux de remise",
       x = "Catégorie de remise",
       y = "Profit ($)") +
  theme_minimal() +
  theme(legend.position = "none")
```



### Analyse graphique

#### Avec le scatter plot :

- Nous observons une tendance globale légèrement négative entre le taux de remise et le profit.
- Plus la remise augmente, plus les profits tendent à baisser.

#### Avec le boxplot :

- La **structure des données** devient beaucoup plus claire.
- Jusqu'à **20% de remise**, les profits restent majoritairement positifs.
- Dès que la remise dépasse **40%**, la médiane du profit devient négative.
- Nous constatons également que la variabilité augmente fortement avec les remises élevées.

#### Différence entre Scatter plot et Boxplot pour ce problème :

- Le **scatter plot** nous a permis d'observer une tendance générale.
- Le **boxplot** nous permet de **comparer plus précisément les profits** selon différents niveaux de remise, en mettant en évidence :
  - Les tendances centrales (**médiane**)
  - La dispersion (**écart interquartile**)


### Conclusion

- Sans remise ou avec une remise légère (**0%-20%**), les ventes restent globalement rentables.
- Dès que la remise atteint **20%-40%**, la rentabilité diminue visiblement.
- Pour des remises supérieures à **40%**, les pertes deviennent la norme dans la majorité des cas.

Notre analyse montre que :

- Accorder une réduction importante n'assure pas un profit ; au contraire, cela augmente considérablement le risque de pertes.
- Le **scatter plot** nous a permis d'identifier une tendance générale.
- Le **boxplot** a confirmé et précisé que les remises élevées entraînent majoritairement des profits négatifs.


## Question 4 :Quels produits rapportent le plus ?

### Méthode

Pour répondre à cette question,Nous nous concentrerons principalement sur deux paramètres : 
**product_line** : ce paramètre nous informe sur le type de produit, et **gross_income** : ce paramètre nous indique le bénéfice généré par le produit.

Nous utiliserons un diagramme en barres pour analyser les données, car les catégories de produits possèdent plusieurs étiquettes différentes, tandis que le revenu des produits est une valeur unique. Après avoir trié les données, la comparaison entre les produits sera également plus intuitive.

### Visualisation

#### Bar chart: product_line et gross_income

```{r message=FALSE}
library(dplyr)
library(readr)
library(ggplot2)
library(scales)  # 记得先加载 scales 包

data <- read_delim(
  "data/WalmartSQL repository..csv",
  delim = ";", 
  show_col_types = FALSE
)

result <- data %>%
  group_by(product_line) %>%
  summarise(total_gross_income = sum(gross_income, na.rm = TRUE)) %>%
  arrange(desc(total_gross_income))


ggplot(result, aes(x = reorder(product_line, total_gross_income), y = total_gross_income)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  coord_flip() + 
  labs(title = "Revenu total par catégorie de produits",
       x = '',
       y = "Revenu brut (en dollars)") +
  scale_y_continuous(labels = dollar) +
  geom_text(aes(label = dollar(total_gross_income)), 
            position = position_stack(vjust = 0.5),
            size = 4, color = "white") +  
  theme_minimal()
```


### Résultat et Conclusion

Nous pouvons observer que les produits du supermarché Walmart sont répartis en six catégories. Parmi celles-ci, la vente de food and beverages génère le bénéfice le plus élevé, tandis que health and beauty génère le bénéfice le plus faible.
Toutefois, il est important de noter que l'écart entre eux n'est pas très important. Pour certains produits, la différence de bénéfices ne dépasse même pas 2%. De plus, tous les bénéfices dépassent 2000 dollars. Étant donné que les données collectées peuvent être influencées par le contexte social et d'autres facteurs à l'époque, nous pouvons conclure qu'au premier trimestre de 2019, la vente de food and beverages générait les bénéfices les plus élevés.






